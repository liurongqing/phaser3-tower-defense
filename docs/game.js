!function(e){var t={};function s(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(i,a,function(t){return e[t]}.bind(null,a));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=0)}([function(e,t,s){"use strict";s.r(t);var i={};s.r(i),s.d(i,"Boot",function(){return l}),s.d(i,"Preloader",function(){return h}),s.d(i,"Main",function(){return u}),s.d(i,"Title",function(){return d}),s.d(i,"UI",function(){return p});var a=[[0,-1,0,0,0,0,0,0,0,0],[0,-1,0,0,0,0,0,0,0,0],[0,-1,-1,-1,-1,-1,-1,-1,0,0],[0,0,0,0,0,0,0,-1,0,0],[0,0,0,0,0,0,0,-1,0,0],[0,0,0,0,0,0,0,-1,0,0],[0,0,0,0,0,0,0,-1,0,0],[0,0,0,0,0,0,0,-1,0,0]],r={initial:{enemySpeed:1e-5,enemyHealth:50,bulletDamage:50,numOfEnemies:8,numOfTurrets:2,baseHealth:3},incremental:{enemySpeed:5,enemyHealth:50,numOfEnemies:2,numOfTurrets:1}};const n="./",o="./";class l extends Phaser.Scene{constructor(){super("BootScene")}preload(){this.load.setBaseURL(n),this.load.setPath(o),this.load.image("logo","logo/zenva_logo.png")}create(){this.scene.start("PreloaderScene")}}class h extends Phaser.Scene{constructor(){super("PreloaderScene"),console.log("Preloader...")}init(){this.readyCount=0}preload(){this.load.setBaseURL(n),this.load.setPath(o),this.time.delayedCall(1,this.ready,[],this),this.createPreloader(),this.loadAssets()}createPreloader(){const e=this.cameras.main.width,t=this.cameras.main.height,s=this.add.graphics(),i=this.add.graphics();s.fillStyle(2236962,.8),s.fillRect(e/2-160,t/2-30,320,50);const a=this.make.text({x:e/2,y:t/2-50,text:"Loading...",style:{font:"20px monospace",fill:"#ffffff"},origin:[.5,.5]}),r=this.make.text({x:e/2,y:t/2-5,text:"0%",style:{font:"18px monospace",fill:"#ffffff"},origin:[.5,.5]}),n=this.make.text({x:e/2,y:t/2+50,text:"",style:{font:"18px monospace",fill:"#ffffff"},origin:[.5,.5]});this.load.on("progress",s=>{r.setText(parseInt(String(100*s))+"%"),i.clear(),i.fillStyle(16777215,.9),i.fillRect(e/2-150,t/2-20,300*s,30)}),this.load.on("fileprogress",e=>{n.setText(`Loading asset: ${e.key}`)}),this.load.on("complete",()=>{s.destroy(),i.destroy(),n.destroy(),a.destroy(),r.destroy(),this.ready()})}loadAssets(){this.load.image("bullet","level/bulletDark2_outline.png"),this.load.image("tower","level/tank_bigRed.png"),this.load.image("enemy","level/tank_sand.png"),this.load.image("base","level/tankBody_darkLarge_outline.png"),this.load.image("title","ui/title.png"),this.load.image("cursor","ui/cursor.png"),this.load.image("blueButton1","ui/blue_button02.png"),this.load.image("blueButton2","ui/blue_button03.png"),this.load.tilemapTiledJSON("level1","level/level1.json"),this.load.spritesheet("terrainTiles_default","level/terrainTiles_default.png",{frameWidth:64,frameHeight:64})}ready(){this.readyCount++,2===this.readyCount&&this.scene.start("MainScene")}}class c extends Phaser.GameObjects.Image{constructor(e,t,s,i){super(e,t,s,"enemy"),this.scene=e,this.path=i,this.hp=0,this.enemySpeed=0,this.follower={t:0,vec:new Phaser.Math.Vector2},this.scene.add.existing(this)}update(e,t){console.log("enemy.update..."),this.follower.t+=this.enemySpeed*t,this.path.getPoint(this.follower.t,this.follower.vec),this.follower.vec.y>this.y&&this.follower.vec.y!==this.y&&(this.angle=0),this.follower.vec.x>this.x&&this.follower.x!==this.x&&(this.angle=-90),this.setPosition(this.follower.vec.x,this.follower.vec.y),this.follower.t>=1&&(this.setActive(!1),this.setVisible(!1))}startOnPath(){this.hp=r.initial.enemyHealth+r.incremental.enemyHealth,this.enemySpeed=r.initial.enemySpeed*r.incremental.enemySpeed,this.follower.t=0,this.path.getPoint(this.follower.t,this.follower.vec),this.setPosition(this.follower.vec.x,this.follower.vec.y)}recieveDamage(e){this.hp-=e,this.hp<=0&&(this.setActive(!1),this.setVisible(!1))}}class u extends Phaser.Scene{constructor(){super("MainScene"),console.log("mainscene....")}init(){this.map=a.map(e=>e.slice()),this.nextEnemy=0}create(){this.createMap(),this.createPath(),this.createCursor(),this.createGroups()}update(e,t){if(e>this.nextEnemy){let t=this.enemies.getFirstDead();t||(t=new c(this,0,0,this.path)),t&&(t.setActive(!0),t.setVisible(!0),t.startOnPath(),this.nextEnemy=e+2e3)}}createMap(){this.bgMap=this.make.tilemap({key:"level1"}),this.tiles=this.bgMap.addTilesetImage("terrainTiles_default"),this.backgroundLayer=this.bgMap.createStaticLayer("Background",this.tiles,0,0),this.add.image(480,480,"base")}createPath(){this.graphics=this.add.graphics(),this.path=this.add.path(96,-32),this.path.lineTo(96,164),this.path.lineTo(480,164),this.path.lineTo(480,544),this.graphics.lineStyle(3,16777215,1),this.path.draw(this.graphics)}createCursor(){this.cursor=this.add.image(32,32,"cursor"),this.cursor.setScale(2),this.cursor.setAlpha(0),this.input.on("pointermove",e=>{const t=Math.floor(e.y/64),s=Math.floor(e.x/64);this.canPlaceTurret(t,s)?(this.cursor.setPosition(64*s+32,64*t+32),this.cursor.setAlpha(.8)):this.cursor.setAlpha(0)})}createGroups(){this.enemies=this.physics.add.group({classType:c,runChildUpdate:!0})}canPlaceTurret(e,t){return 0===this.map[e][t]}}class d extends Phaser.Scene{constructor(){super("TitleScene"),console.log("Title...")}create(){this.createTitle(),this.createPlayButton()}createTitle(){this.titleImage=this.add.image(0,0,"title"),this.centerObject(this.titleImage,1)}createPlayButton(){this.gameButton=this.add.sprite(0,0,"blueButton1").setInteractive(),this.centerObject(this.gameButton,-1),this.gameText=this.add.text(0,0,"play",{fontSize:"32px",fill:"#fff"}),Phaser.Display.Align.In.Center(this.gameText,this.gameButton),this.gameButton.on("pointerdown",e=>{this.scene.start("MainScene")}),this.gameButton.on("pointerover",e=>{this.gameButton.setTexture("blueButton2")}),this.gameButton.on("pointerout",e=>{this.gameButton.setTexture("blueButton1")})}centerObject(e,t=0){const s=this.cameras.main.width,i=this.cameras.main.height;e.x=s/2,e.y=i/2-100*t}}class p extends Phaser.Scene{constructor(){super("UIScene")}preload(){}create(){}}const f=[];for(let e in i)f.push(i[e]);const m={type:Phaser.AUTO,backgroundColor:0,parent:"app",width:640,height:512,autoCenter:Phaser.Scale.CENTER_BOTH,pixelArt:!0,roundPixels:!0,physics:{default:"arcade",arcade:{debug:!0,gravity:{y:0}}},scene:f};window.game=new Phaser.Game(m)}]);